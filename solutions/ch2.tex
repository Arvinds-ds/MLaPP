
\documentclass{article}
\usepackage{amsmath,amsthm}
\usepackage{cancel}
\usepackage{indentfirst}
\begin{document}

 % From Wikipedia, not sure where to define this yet...
\def\ci{\perp\!\!\!\perp}

\section{Probabilities are sensitive to the form of the question that
  was used to generate the answer}

\subsection{}

Possible outcomes for $X$, the genders of the two children, are

\[
X\in \left\{ (B,B), (B,G), (G,B), (\cancel{G,G})\right\}
\]

We have eliminated the possiblity of two girls. There are two
remaining outcomes that include at least one girl, so the probability is $\frac{2}{3}$.

\subsection{}

$X \in \{ B, G \}$, so the probability is simply $\frac{1}{2}$.

\section{Legal reasoning}

\subsection{}

\begin{list}{}{}
\item Let $G$ = defendant is guilty
\item Let $B$ = defendant's blood type matches blood type at the scene
\end{list}

The probability that the defendant is guilty given that the
defendant's blood type was found at the scene is then

\[ P(G|B) = \frac{P(G \cap B)}{P(B)} \]

The prosecutor is confusing $P(B)$ for $P(G|B)$. The prosecutor is failing
to account for $P(G)$, the prior probability that the defendant
committed the crime, which is extremely low.

\subsection{}

The defense attorney is ignoring all of the other evidence against the
defendant. Not all of the 8000 people with the matching blood type are
equally likely to have committed the crime.

\section{Variance of a sum}
Prove: $var[X + Y] = var[X] + var[Y] + 2cov[X,Y]$

\begin{align}
  var[X] &= E[X^2]-\mu^2 \\
  cov[X,Y] &= E[XY] - E[X]E[Y]
\end{align}
\begin{align*}
  var[X+Y] &= E[(X+Y)(X+Y)] - E^2[X+Y] \\
           &= E[X^2+2XY+Y^2] - E^2[X+Y] \\
           &= E[X^2+2XY+Y^2] - (\mu_x + \mu_y)^2 \\
           &= E[X^2+2XY+Y^2] - (\mu_x^2 + 2\mu_x\mu_y + \mu_y^2) \\
           &= E[X^2+2XY+Y^2] - \mu_x^2 - 2\mu_x\mu_y - \mu_y^2 \\
           &= E[X^2] - \mu_x^2 + E[Y^2] - \mu_y^2 + 2(E[XY]-\mu_x\mu_y)
             \text{\qquad(By linearity of expectations)}\\
           &= var[X] + var[Y] + 2cov[X,Y] \\
           &= var[X + Y] \qed
\end{align*}

\section{Bayes rule for medical diagnosis}

\begin{list}{}{}
\item Let D = You have the disease
\item Let T = You test positive
\end{list}

\begin{align*}
  P(D) &= \frac{1}{10000} & P(\bar{D}) &= \frac{9999}{10000} \\
  P(T|D) &= \frac{99}{100} & P(T|\bar{D}) &= \frac{1}{100} \\
  P(D|T) &= \frac{P(D \cap T)}{P(T)} = \frac{P(T \cap D)}{P(T)} \\
  P(D|T) &= \frac{P(T|D)P(D)}{P(T)} \\
  P(D|T) &= \frac{P(T|D)P(D)}{P(T|D)P(D) + P(T|\bar{D})P(\bar{D})} \\
  P(D|T) &= \frac{(.99)(.0001)}{(.99)(.0001) + (.01)(.9999)} \\
  P(D|T) &= .98\%
\end{align*}

\section{The Monty Hall problem}

\begin{list}{}{}
\item Let $A$ = the prize is behind door 1
\item Let $B$ = the prize is behind door 2
\item Let $C$ = the prize is behind door 3
\item Let $c$ = the host opens door 3
\end{list}

\begin{align*}
  P(A) = P(B) = P(C) &= \frac{1}{3} \\
  P(c|A) &= \frac{1}{2} \\
  P(c|B) &= 1 \\
  P(c|C) &= 0
\end{align*}

\begin{align*}
  P(B|c) &= \frac{P(c|B)P(B)}{P(c)} \\
  &= \frac{P(c|B)P(B)}{P(c|A)P(A) + P(c|B)P(B) + P(c|C)p(C)} \\
  &= \frac{\frac{1}{3}}{\frac{1}{6} + \frac{2}{6} + 0} \\
  &= \frac{2}{3}
\end{align*}

There is a $\frac{2}{3}$ chance that the prize is behind door 2, so
the contestant should definitely switch.

\section{Conditional independence}
\subsection{}

\begin{align*}
  P(H=k|e_1,e_2) &= \frac{P(H=k \cap e_1,e_2)}{P(e_1,e_2)} \\
  &= \frac{P(e_1 \cap e_2|H=k)P(H=k)}{P(e_1,e_2)} \qquad \text{(ii.)}
\end{align*}

(ii.) is sufficient.

\subsection{}

\begin{equation*}
  E_1 \ci E_2 | H \implies P(e_1,e_2|H) = P(e_1|H) \cdot P(e_2|H)
\end{equation*}
\begin{align*}
    P(H=k|e_1,e_2) &= \frac{P(e_1 \cap e_2|H=k)P(H=k)}{P(e_1,e_2)} \\
    &= \frac{P(e_1|H=k)P(e_2|H=k)P(H=k)}{P(e_1,e_2)} \qquad
    \text{(i.)} \\
    &= \frac{P(e_1|H=k)P(e_2|H=k)P(H=k)}{\sum\limits_{j=1}^K
      P(e_1,e_2|H=j)P(H=j)} \\
    &= \frac{P(e_1|H=k)P(e_2|H=k)P(H=k)}{\sum\limits_{j=1}^K
      P(e_1|H=j)P(e_2|H=j)P(H=j)} \qquad \text{(iii.)}
\end{align*}

(i.), (ii.), and (iii.) are each sufficient.

\section{Pairwise independence does not imply mutual independence}

Example: Let X and Y represent two coin tosses, with value 0 or 1 for
heads or tails, respectively. Let Z = 1 if two coin tosses result in
exactly one heads.

\[ (X, Y, Z) = \left\{
  \begin{array}{ccc}
    ( 0, & 0, & 0 ) \\
    (0, & 1, & 1) \\
    (1, & 0, & 1) \\ 
    (1, & 1, & 0)
  \end{array}
\right\}
\]

\begin{gather*}
  P(X=1) = P(Y=1) = P(Z=1) = \frac{1}{2} \\
  P(X=1|Y=1) = P(X=1|Z=1) = P(Y=1|Z=1) = \frac{1}{2} \\
  P(X=1,Y=1,Z=1) \stackrel{?}{=} P(X=1)P(Y=1)P(Z=1) \\
  0 \neq \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2}
\end{gather*}

The state of any two variables $\in (X, Y, Z)$ determines the third.
This means that $X$, $Y$, and $Z$ are pairwise independent, but
\textbf{not} mutually independent.

\section{Conditional independence iff joint factorizes}

\setcounter{equation}{0}

By definition, $X \ci Y | Z$ iff

\begin{equation} \label{eq:8-1}
  p(x,y|z) = p(x|z)p(y|z)
\end{equation}

We wish to prove an alternate definition - $X \ci Y | Z$ iff there
exist functions $g$ and $h$ such that

\begin{equation} \label{eq:8-2}
  p(x,y|z) = g(x,z)h(y,z)
\end{equation}

for all $x, y$ and $z$ such that $p(z) > 0$.

To prove this we will show that given equation \ref{eq:8-2}, equation
\ref{eq:8-1} follows, and $X \ci Y | Z$.

We begin by integrating out $x$.

\begin{align*}
  \int_x p(x,y|z) dx &= \int_x g(x,z)h(y,z)dx \\
  p(y|z) &= h(y,z)g(z) \\
  p(y|z) \frac{1}{g(z)} &= h(y,z)
\end{align*}

By a symmetric argument, we have $p(x|z) \frac{1}{h(z)} = g(x,z)$.
Plugging into our original equation, we have

\begin{align*}
  p(x,y|z) &= p(y|z)p(x|z)\frac{1}{g(z)}\frac{1}{h(z)} \\
  \int_x \int_y p(x,y|z) dx dy &= \int_x \int_y
                                 p(y|z)p(x|z)\frac{1}{g(z)}\frac{1}{h(z)}
  dx\,dy \\
  1 &= \frac{1}{g(z)}\frac{1}{h(z)} \\
  p(x,y|z) &= p(y|z)p(x|z) \cdot 1 \qed
\end{align*}

\section{Conditional independence}

\subsection{}

\setcounter{equation}{0}

\[
\overbrace{(X \ci W | Z,Y)}^{A} \wedge \overbrace{(X \ci Y | Z)}^{B}
\stackrel{?}{\implies} (X \ci Y,W | Z)
\]

By decomposition of $(X \ci Y,W | Z)$, we have

\begin{equation} \label{eq:9-1}
  X \ci Y | Z
\end{equation}

\begin{equation} \label{eq:9-2}
  X \ci W | Z
\end{equation}

(\ref{eq:9-1}) is trivally true by (B). Now we must examine
(\ref{eq:9-2}).

\[
\overbrace{(X \ci W | Z,Y)}^{A} \wedge \overbrace{(X \ci Y | Z)}^{B}
\stackrel{?}{\implies} (X \ci W | Z)
\]

\begin{align*}
  P(X|WYZ) &= P(X|YZ) \quad &\text{by (B)} \\
  &= P(X|Z) \quad &\text{by (A)} \\
  P(X|WYZ) &= P(X|WZ) \quad &\text{by (A)} \\
  P(X|Z) &= P(X|WZ) \implies X \ci W | Z
\end{align*}

Both (\ref{eq:9-1}) and (\ref{eq:9-2}) are true, so it is true that
\[
(X \ci W | Z,Y) \wedge (X \ci Y | Z) \implies (X \ci Y,W | Z)
\]

\subsection{}

\[
(X \ci Y | Z) \wedge (X \ci Y | W) \stackrel{?}{\implies} (X \ci Y | Z,W)
\]

We disprove this with a counter example. Let $X$, $Y$, and $Z$ be
i.i.d., where

\[
P(X) =
\begin{cases}
.5, \quad &\text{ X = 1} \\
.5, \quad &\text{X = -1}
\end{cases}
\]

Let $W = XYZ$.

\par
Given $Z$, knowledge of $Y$ gives no additional information about $X$.
\par
Given $W$, knowledge of $Y$ gives no additional information about $X$.
\par
Given $W,Z$ however, $X$ and $Y$ are \textbf{not} independent, because
$XY = WZ$.

\section{Deriving the inverse gamma density}

\begin{align*}
  X &\sim \text{Ga}(a,b) \\
  p(x) &= \text{Ga}(x|a,b) = \frac{b^a}{\Gamma(a)} x^{a-1}e^{-xb} \\
  P_{x}(x) &= \int{f(x) \; dx} \\
  P_{x}(x) &= \int{\frac{b^{a}}{\Gamma(a)} x^{a-1} e^{-xb} \; dx}
\end{align*}

Now we change variables to find the cdf of $Y$, $P_{y}(y)$
\begin{align*}
  x &= \frac{1}{y} = y^{-1} \\
  \frac{dx}{dy} &= -y^{-2} = -\frac{1}{y^{2}} \\
  dx &= -\frac{1}{y^{2}} \\
  P_{y}(y) &= \int{ \frac{b^{a}}{\Gamma(a)}
             \left( y^{-1} \right) ^{a-1} e^{-\frac{b}{y}}
             y^{-2} \; dy} \\
    &= \int{ \frac{b^{a}}{\Gamma(a)}
      y^{-(a+1)} e^{-\frac{b}{y}}} \; dy \\
  p(y) &= \frac{b^{a}}{\Gamma(a)}
      y^{-(a+1)} e^{-\frac{b}{y}} \\
  &= IG(y|a,b)
\end{align*}

\section{Normalization constant for a 1D Gaussian}

After squaring Z and converting to polar coordinates, we have
\begin{align*}
  Z^{2} &= \int_0^{2\pi} \int_0^\infty re^{\frac{-r^{2}}{2\sigma^{2}}}
          \; dr d\theta \\
  &= \Big[ \theta \int_0^\infty{re^{-\frac{r^{2}}{2\sigma^{2}}} \; dr}
    \Big]_0^{2\pi} \\
  &= 2\pi \int_0^\infty{re^{-\frac{r^{2}}{2\sigma^{2}}}} \; dr
\end{align*}

Let $u = \phi(r) = e^{-\frac{r^{2}}{2\sigma^{2}}}$.

\begin{align*}
  \frac{du}{dr} &= -\frac{r}{\sigma^{2}}
                  e^{-\frac{r^{2}}{2\sigma^{2}}} \\
  du &= -\frac{r}{\sigma^{2}}
                  e^{-\frac{r^{2}}{2\sigma^{2}}} dr \\
  \frac{-\sigma^{2}}{u} du &= r \; dr \\
  \phi(0) &= 1 \\
  \phi(\infty) &= e^{-\infty} = 0
\end{align*}

Now we plug $u$ and $r \; dr$ back into our equation for $Z^2$.
\begin{align*}
  Z^2 &= 2\pi \int_1^0{u -\frac{\sigma^{2}}{u}} \; du \\
  &= -2\pi \int_1^0{\sigma^{2}} \; du \\
  &= -2\pi \sigma^{2} \cdot \Big[ u \Big]_1^0 \\
  &= 2\pi \sigma^{2} \\
  Z &= \pm \sqrt{2\pi\sigma} \\
  &= \sqrt{2\pi\sigma}
\end{align*}

We take only the positive value, since we arbitrarily squared Z at the
beginning of our derivation.

\end{document}
